@using ChokaQ.Abstractions.Enums
@namespace ChokaQ.TheDeck.UI.Components.Circuits
@implements IDisposable

<section class="circuits">
    <h3 class="circuits__title">System Health (Circuit Breakers)</h3>
    
    @if (Breakers == null || !Breakers.Any())
    {
        <div class="circuits__empty">
            System Healthy (No active breakers)
        </div>
    }
    else
    {
        <div class="circuits__list">
            @foreach (var circuit in Breakers)
            {
                <article class="circuits__item @GetStatusModifier(circuit.Status)">
                    <div class="circuits__name" title="@circuit.JobType">
                        @FormatName(circuit.JobType)
                    </div>
                    <div class="circuits__status-row">
                         <span class="circuits__icon @GetIconModifier(circuit.Status)">@GetIcon(circuit.Status)</span>
                         @if (circuit.Status == CircuitStatus.Open && circuit.ResetAtUtc.HasValue)
                         {
                             <span class="circuits__timer">@GetTimeRemaining(circuit.ResetAtUtc.Value)</span>
                         }
                         else
                         {
                             <span class="circuits__status-label">@circuit.Status.ToString().ToUpper()</span>
                         }
                    </div>
                </article>
            }
        </div>
    }
</section>
