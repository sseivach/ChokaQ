@page "/the-deck"
@using ChokaQ.TheDeck.UI.Components.HeaderLeft
@using ChokaQ.TheDeck.UI.Components.HeaderRight
@using ChokaQ.TheDeck.UI.Components.Stats
@using ChokaQ.TheDeck.UI.Components.JobMatrix
@using ChokaQ.TheDeck.UI.Components.Queues
@using ChokaQ.TheDeck.UI.Components.ConsoleLog
@using ChokaQ.TheDeck.UI.Components.Settings
@using ChokaQ.TheDeck.UI.Components.Circuits
@using ChokaQ.TheDeck.UI.Components.OpsPanel
@namespace ChokaQ.TheDeck.UI.Pages
@implements IAsyncDisposable

<main class="deck">
    
    <!-- Left column: Main activity -->
    <div class="deck__col deck__col--main">
        <header class="deck__row deck__row--header">
            <HeaderLeft />
        </header>

        <section class="deck__row deck__row--queues">
            <Queues HubConnection="_hubConnection" />
        </section>

        <nav class="deck__row deck__row--stats">
            <Stats Counts="_counts" SelectedStatus="_activeStatusFilter" OnStatusSelected="HandleStatusSelected" />
        </nav>

        <section class="deck__row deck__row--matrix">
            <JobMatrix Jobs="_jobs" 
                       IsConnected="IsConnected" 
                       HubConnection="_hubConnection" 
                       ActiveStatusFilter="_activeStatusFilter" 
                       OnClearHistory="ClearHistory"
                       OnJobSelected="HandleJobInspectorRequested" />
        </section>

        <footer class="deck__row deck__row--console">
            <ConsoleLog Logs="_logs" />
        </footer>
    </div>

    <!-- Right column: Sidebar/Ops -->
    <aside class="deck__col deck__col--side">
        <header class="deck__row deck__row--header">
            <HeaderRight />
        </header>

        <section class="deck__row deck__row--settings">
            <Settings />
        </section>

        <section class="deck__row deck__row--circuits">
            <Circuits Breakers="_circuits" />
        </section>

        <section class="deck__row deck__row--ops">
            <OpsPanel @ref="_opsPanel" OnRequeue="HandleRequeueRequested" OnDelete="HandleDeleteRequested" />
        </section>
    </aside>

</main>
