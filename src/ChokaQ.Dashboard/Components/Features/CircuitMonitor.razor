@using ChokaQ.Abstractions.Enums

@if (_circuits.Any())
{
    <div class="card cq-card cq-shadow-small cq-margin-bottom-2">
        <div class="cq-padding-top-0-5 cq-padding-bottom-0-5 cq-flex cq-align-items-center cq-gap-0-5"
             style="background-color: var(--cq-panel-bg); border-bottom: 1px solid var(--cq-border);">
            <h6 class="cq-margin-bottom-0 cq-font-bold cq-font-size-small cq-text-uppercase" style="color: var(--cq-text-muted)">
                System Health (Circuit Breakers)
            </h6>
        </div>
        <div class="cq-padding-1">
            <div class="cq-flex cq-flex-wrap cq-gap-0-5">
                @foreach (var circuit in _circuits)
                {
                    <div class="cq-flex cq-align-items-center cq-gap-0-5 cq-padding-left-1 cq-padding-right-1 cq-padding-top-0-25 cq-padding-bottom-0-25 cq-border"
                         style="border-color: var(--cq-border) !important; background-color: @GetBgColor(circuit.Status); border-radius: 4px;">

                        <span style="font-size: 0.8rem;">@GetIcon(circuit.Status)</span>

                        <div class="cq-flex cq-flex-column" style="line-height: 1.1;">
                            <span class="cq-font-size-small cq-font-bold">@FormatName(circuit.JobType)</span>

                            @if (circuit.Status == CircuitStatus.Open && circuit.ResetAtUtc.HasValue)
                            {
                                <span style="font-size: 0.65rem; color: var(--cq-danger); font-weight: bold; font-family: monospace;">
                                    RESET IN: @GetTimeRemaining(circuit.ResetAtUtc.Value)
                                </span>
                            }
                            else
                            {
                                <span style="font-size: 0.65rem; color: var(--cq-text-muted);">
                                    @circuit.Status.ToString().ToUpper()
                                </span>
                            }
                        </div>
                    </div>
                }
            </div>
        </div>
    </div>
}